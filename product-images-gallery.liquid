{% comment %}
  Product Images Gallery Section
  Displays images from product metafield custom.product_images
{% endcomment %}

{%- assign product_images = product.metafields.custom.product_images.value -%}

<section class="product-images-gallery" style="background-color: {{ section.settings.background_color }};">
  {%- if product_images and product_images.size > 0 -%}
    <div class="product-images-gallery__grid" style="--columns-desktop: {{ section.settings.columns_desktop }}; --columns-mobile: {{ section.settings.columns_mobile }};">
      {%- for image in product_images -%}
        <div class="product-images-gallery__item">
          <div class="product-images-gallery__image-wrapper">
            <img
              src="{{ image | image_url: width: 1920 }}"
              alt="{{ image.alt | default: product.title }}"
              loading="lazy"
              width="{{ image.width }}"
              height="{{ image.height }}"
              class="product-images-gallery__image"
            >
          </div>
        </div>
      {%- endfor -%}
    </div>
  {%- else -%}
    {%- if section.settings.show_placeholder -%}
      <div class="product-images-gallery__placeholder">
        <p>No images added yet. Add images to the product metafield 'custom.product_images'.</p>
      </div>
    {%- endif -%}
  {%- endif -%}
</section>

<style>
.product-images-gallery {
  padding: 0;
  width: 100%;
}

.product-images-gallery__grid {
  display: grid;
  grid-template-columns: repeat(var(--columns-desktop, 4), 1fr);
  gap: 0;
}

.product-images-gallery__item {
  position: relative;
  overflow: hidden;
}

.product-images-gallery__image-wrapper {
  position: relative;
  width: 100%;
  padding-bottom: 100%; /* 1:1 aspect ratio */
  overflow: hidden;
}

.product-images-gallery__image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.product-images-gallery__placeholder {
  text-align: center;
  padding: 60px 20px;
  color: #666;
  font-size: 16px;
}

/* Tablet */
@media screen and (max-width: 990px) {
  .product-images-gallery__grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

/* Mobile */
@media screen and (max-width: 749px) {
  .product-images-gallery__grid {
    grid-template-columns: repeat(var(--columns-mobile, 2), 1fr);
  }

  .product-images-gallery__placeholder {
    padding: 40px 20px;
    font-size: 14px;
  }
}
</style>

{% schema %}
{
  "name": "Product Images Gallery",
  "tag": "section",
  "class": "section-product-images-gallery",
  "settings": [
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "Number of columns (Desktop)",
      "default": 4
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "label": "Number of columns (Mobile)",
      "default": 2
    },
    {
      "type": "checkbox",
      "id": "show_placeholder",
      "label": "Show placeholder when no images",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Product Images Gallery"
    }
  ]
}
{% endschema %}
